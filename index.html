<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pixel Games - Value List</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ===============================
   BASE
================================ */
body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: #050508;
  color: #e6d9ff;
  display: flex;
  height: 100vh;
  overflow: hidden;
  transition: all 0.3s ease;
}

/* ==================================================
   DEVICE OVERLAY
================================================== */
#deviceOverlay {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at top, #12081f, #050508);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

#deviceOverlay h1 {
  margin-bottom: 30px;
  color: #e6d9ff;
  text-align: center;
}

.device-options {
  display: flex;
  gap: 30px;
  flex-wrap: wrap;
  justify-content: center;
}

.device-box {
  width: 180px;
  height: 140px;
  border-radius: 14px;
  background: #0b0b16;
  border: 1px solid #7a3cff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 22px;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 0 25px #7a3cff55;
  transition: all 0.3s ease;
}

.device-box:hover {
  transform: scale(1.1);
  box-shadow: 0 0 40px #9b6cff;
}

/* ==================================================
   SIDEBAR
================================================== */
.sidebar {
  width: 220px;
  background: #090912;
  padding-top: 60px;
  padding-left: 15px;
  display: flex;
  flex-direction: column;
  box-shadow: 2px 0 20px #7a3cff33;
  transition: transform 0.3s ease;
}

.sidebar.collapsed {
  transform: translateX(-100%);
}

.sidebar button {
  background: none;
  border: none;
  color: #e6d9ff;
  font-size: 18px;
  padding: 12px 20px;
  text-align: left;
  cursor: pointer;
  margin-bottom: 10px;
  transition: all 0.3s ease;
  animation: sidebarPulse 3s infinite;
}

.sidebar button:hover {
  background: #1b0a32;
  transform: scale(1.05);
  box-shadow: 0 0 15px #7a3cff66;
}

@keyframes sidebarPulse {
  0% { box-shadow: 0 0 5px #7a3cff33; }
  50% { box-shadow: 0 0 15px #7a3cff66; }
  100% { box-shadow: 0 0 5px #7a3cff33; }
}

/* ==================================================
   HAMBURGER
================================================== */
#hamburger {
  position: fixed;
  top: 10px;
  left: 10px;
  background: #9b6cff;
  color: white;
  font-weight: bold;
  border: none;
  padding: 10px;
  border-radius: 6px;
  cursor: pointer;
  z-index: 100;
  transition: all 0.3s ease;
}

#hamburger:hover {
  transform: scale(1.15);
  box-shadow: 0 0 20px #9b6cffaa;
}

/* ==================================================
   MAIN
================================================== */
.main {
  flex: 1;
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  overflow-y: auto;
  transition: all 0.3s ease;
}

#home, #values {
  max-width: 1200px;
  width: 100%;
  margin: 0 auto;
}

#home h1 {
  margin-bottom: 10px;
}

#home p {
  font-size: 1rem;
  line-height: 1.5;
}

/* Values document area */
#values #publicView {
  width: 100%;
  height: 80vh;
  background: #0b0b16;
  border: 1px solid #7a3cff;
  border-radius: 8px;
  padding: 16px;
  overflow-y: auto;
  white-space: pre-wrap;
  font-size: 1rem;
  transition: all 0.3s ease;
}

/* Save / Cancel buttons */
#saveBtn, #cancelBtn {
  display: none;
  margin-top: 10px;
  background: #7a3cff;
  border: none;
  border-radius: 6px;
  padding: 10px 20px;
  font-weight: bold;
}

#saveBtn:hover, #cancelBtn:hover {
  background: #9b6cff;
  transform: scale(1.05);
}

/* ==================================================
   DEV LOGIN (PC ONLY)
================================================== */
#devLogin {
  position: fixed;
  top: 20px;
  right: 20px;
  background: #9b6cff;
  color: white;
  font-weight: bold;
  border: none;
  padding: 10px 15px;
  border-radius: 6px;
  cursor: pointer;
  box-shadow: 0 0 20px #7a3cffaa;
}

body:not(.device-pc) #devLogin {
  display: none;
}

/* ==================================================
   DEVICE-SPECIFIC LAYOUT
================================================== */
body.device-phone #values #publicView {
  height: 70vh;
  font-size: 0.95rem;
}

body.device-tablet #values #publicView {
  width: 95%;
}

body.device-pc #values #publicView {
  width: 100%;
}

/* ==================================================
   MOBILE FIXES
================================================== */
@media (max-width: 768px) {
  .sidebar {
    position: fixed;
    z-index: 10;
    height: 100%;
  }

  .sidebar.collapsed {
    transform: translateX(-100%);
  }

  .main {
    margin-left: 0 !important;
    width: 100%;
    padding: 10px;
  }
}

@media (max-width: 480px) {
  .device-options {
    flex-wrap: wrap;
    gap: 15px;
    justify-content: center;
  }

  .device-box {
    width: 120px;
    height: 100px;
    font-size: 18px;
  }

  #deviceOverlay h1 {
    font-size: 1.2rem;
    text-align: center;
    margin-bottom: 20px;
  }
}
</style>
</head>

<body>

<!-- DEVICE SELECT -->
<div id="deviceOverlay">
  <h1>Select Your Device</h1>
  <div class="device-options">
    <div class="device-box" onclick="selectDevice('phone')">ðŸ“± Phone</div>
    <div class="device-box" onclick="selectDevice('tablet')">ðŸ“± Tablet</div>
    <div class="device-box" onclick="selectDevice('pc')">ðŸ–¥ PC</div>
  </div>
</div>

<button id="hamburger" onclick="toggleSidebar()">â˜°</button>

<div class="sidebar" id="sidebar">
  <button onclick="showTab('home')">Home</button>
  <button onclick="showTab('values')">Values</button>
</div>

<div class="main">
  <div id="home" class="tab">
    <h1>Welcome to Pixel Games Official PSX:R Value List</h1>
    <p>This is the Official Value List for Pet Simulator X: Return. To check the values please go to the values tab on the left.</p>
  </div>

  <div id="values" class="tab" style="display:none;">
    <div id="publicView">Loading document...</div>
    <button id="saveBtn">Save</button>
    <button id="cancelBtn">Cancel</button>
  </div>
</div>

<button id="devLogin">Developer Login</button>

<script>
/* ===============================
   DEVICE SELECTION
================================ */
function selectDevice(type){
  document.body.classList.remove("device-phone","device-tablet","device-pc");
  document.body.classList.add(`device-${type}`);
  document.getElementById("deviceOverlay").style.display = "none";
  localStorage.setItem("deviceType", type);
}

const savedDevice = localStorage.getItem("deviceType");
if(savedDevice){
  selectDevice(savedDevice);
}

/* ===============================
   TABS + SIDEBAR
================================ */
function showTab(tab){
  document.querySelectorAll('.tab').forEach(t=>t.style.display='none');
  document.getElementById(tab).style.display='block';
}

function toggleSidebar(){
  const sidebar = document.getElementById('sidebar');
  sidebar.classList.toggle('collapsed');

  recalcMainWidth();
}

function recalcMainWidth(){
  const sidebar = document.getElementById('sidebar');
  const main = document.querySelector('.main');

  if(window.innerWidth <= 768){
    main.style.marginLeft = '0px';
  } else {
    const sidebarWidth = sidebar.classList.contains('collapsed') ? 0 : sidebar.offsetWidth + 15;
    main.style.marginLeft = sidebarWidth + 'px';
  }
}

window.addEventListener('resize', recalcMainWidth);
recalcMainWidth();

/* ===============================
   WebSocket for real-time updates
================================ */
let ws;
function initWebSocket(){
  const protocol = window.location.protocol === "https:" ? "wss" : "ws";
  ws = new WebSocket(`${protocol}://${window.location.host}/ws`);

  ws.onopen = () => console.log("WebSocket connected!");
  ws.onclose = () => console.log("WebSocket closed!");
  ws.onerror = (e) => console.log("WebSocket error", e);

  ws.onmessage = (event)=>{
    const msg = JSON.parse(event.data);
    const publicView = document.getElementById('publicView');
    if(publicView.innerText !== msg.content){
      publicView.innerText = msg.content;
    }
  }
}

initWebSocket();

/* ===============================
   Developer Login + Editing
================================ */
let originalContent = "";

function devLogin(){
  const password = prompt("Enter developer password:");
  if(!password) return;
  window.devPassword = password;
  const publicView = document.getElementById('publicView');

  originalContent = publicView.innerText;
  publicView.contentEditable = true;
  publicView.focus();

  document.getElementById('saveBtn').style.display = 'inline-block';
  document.getElementById('cancelBtn').style.display = 'inline-block';

  alert("Developer mode enabled! You can now edit the document directly. The Save button saves the changes you make to the document, and the Cancel Button reverts any changes you made and takes you out of developer mode.");
}

// Attach devLogin to button with PC check
document.getElementById('devLogin').addEventListener('click', () => {
    if(!document.body.classList.contains('device-pc')){
        alert("Developer login is only available on PC devices!");
        return;
    }
    devLogin();
});

/* ===============================
   Save / Cancel Buttons
================================ */
function cancelEdit(){
  const publicView = document.getElementById('publicView');
  publicView.innerText = originalContent;

  if(ws.readyState === 1){
    ws.send(JSON.stringify({
      content: originalContent,
      password: window.devPassword || ""
    }));
  }

  publicView.contentEditable = false;
  window.devPassword = null;

  document.getElementById('saveBtn').style.display = 'none';
  document.getElementById('cancelBtn').style.display = 'none';

  alert("Changes canceled. Developer mode exited.");
}

const publicView = document.getElementById('publicView');
publicView.addEventListener('input', ()=>{
  if(window.devPassword && ws.readyState===1){
    ws.send(JSON.stringify({
      content: publicView.innerText,
      password: window.devPassword
    }));
  }
});

function forceSave(){
  if(!window.devPassword) return alert("Developer not logged in!");
  if(ws.readyState !== 1) return alert("WebSocket not connected.");
  ws.send(JSON.stringify({
    content: publicView.innerText,
    password: window.devPassword
  }));
  alert("Document force-saved!");
}

// Attach buttons
document.getElementById('saveBtn').addEventListener('click', forceSave);
document.getElementById('cancelBtn').addEventListener('click', cancelEdit);

</script>
</body>
</html>
