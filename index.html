<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pixel Games Value List</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>

/* -------------------- */
/* RESET */
/* -------------------- */
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family: Arial, sans-serif;
}

body{
    background:#0b0c12;
    color:white;
    overflow-x:hidden;
}

/* -------------------- */
/* DEVICE SELECT */
/* -------------------- */
#deviceSelect{
    position:fixed;
    inset:0;
    background:#08080f;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    z-index:9999;
}

#deviceSelect h1{
    margin-bottom:30px;
}

.device-buttons{
    display:flex;
    gap:25px;
    flex-wrap:wrap;
}

.device-btn{
    background:#6a00ff;
    padding:25px 35px;
    border-radius:16px;
    cursor:pointer;
    font-size:22px;
    min-width:160px;
    text-align:center;
    transition:0.2s;
}

.device-btn:hover{
    transform:scale(1.08);
    box-shadow:0 0 15px #8c6bff;
}

/* -------------------- */
/* MAIN LAYOUT */
/* -------------------- */
#app{
    display:flex;
    min-height:100vh;
}

/* -------------------- */
/* SIDEBAR */
/* -------------------- */
#sidebar{
    width:260px;
    background:#0f111a;
    padding:20px;
    transition:0.3s;
}

#sidebar.closed{
    width:0;
    padding:0;
    overflow:hidden;
}

#sidebar h2{
    margin-bottom:20px;
}

.sidebar-btn{
    display:block;
    background:#6a00ff;
    color:white;
    padding:12px;
    border-radius:10px;
    margin-bottom:12px;
    cursor:pointer;
    text-align:center;
    transition:0.2s;
}

.sidebar-btn:hover{
    background:#8445ff;
}

/* -------------------- */
/* CONTENT */
/* -------------------- */
#content{
    flex:1;
    padding:20px;
    transition:0.3s;
    max-width:100%;
}

.centered{
    max-width:900px;
    margin:auto;
}

/* -------------------- */
/* TOP BAR */
/* -------------------- */
#topbar{
    display:flex;
    align-items:center;
    gap:15px;
    margin-bottom:15px;
}

#burger{
    font-size:26px;
    cursor:pointer;
    display:none;
}

/* -------------------- */
/* DOCUMENT */
/* -------------------- */
#docBox{
    background:#11131d;
    padding:20px;
    border-radius:15px;
    min-height:400px;
    white-space:pre-wrap;
    line-height:1.5;
}

/* -------------------- */
/* EDIT MODE */
/* -------------------- */
#editor{
    width:100%;
    min-height:400px;
    background:#0e1018;
    color:white;
    border:none;
    padding:15px;
    border-radius:15px;
    resize:none;
    display:none;
}

/* -------------------- */
/* DEV PANEL */
/* -------------------- */
#devPanel{
    display:none;
    margin-top:15px;
}

.dev-btn{
    background:#ff0055;
    padding:10px 18px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    margin-right:8px;
}

/* -------------------- */
/* MOBILE */
/* -------------------- */
.mobile #sidebar{
    position:fixed;
    height:100%;
    z-index:2000;
}

.mobile #burger{
    display:block;
}

.mobile #content{
    padding:15px;
}

/* -------------------- */
/* TABLET */
/* -------------------- */
.tablet #content{
    max-width:800px;
    margin:auto;
}

</style>
</head>

<body>

<!-- DEVICE MENU -->
<div id="deviceSelect">
    <h1>Select Your Device</h1>
    <div class="device-buttons">
        <div class="device-btn" onclick="setDevice('phone')">üì± Phone</div>
        <div class="device-btn" onclick="setDevice('tablet')">üìü Tablet</div>
        <div class="device-btn" onclick="setDevice('pc')">üñ•Ô∏è PC</div>
    </div>
</div>


<!-- APP -->
<div id="app">

<!-- SIDEBAR -->
<div id="sidebar">

    <h2>Menu</h2>

    <div class="sidebar-btn" onclick="showHome()">üè† Home</div>
    <div class="sidebar-btn" onclick="showValues()">üíé Values</div>
    <div class="sidebar-btn" id="devBtn" onclick="devLogin()">üîí Developer Login</div>

</div>


<!-- CONTENT -->
<div id="content">

    <div id="topbar">
        <div id="burger" onclick="toggleSidebar()">‚ò∞</div>
        <h2 id="pageTitle">Home</h2>
    </div>

    <!-- HOME -->
    <div id="homeView" class="centered">

        <h1>üíé Pixel Games Value List</h1>
        <p style="margin-top:15px;">
            This is the official value list for PSX:R.
        </p>

    </div>


    <!-- VALUES -->
    <div id="valuesView" style="display:none" class="centered">

        <div id="docBox">Loading document...</div>

        <textarea id="editor"></textarea>

        <div id="devPanel">

            <button class="dev-btn" onclick="saveDoc()">üíæ Force Save</button>
            <button class="dev-btn" onclick="cancelEdit()">‚ùå Cancel</button>

        </div>

    </div>

</div>
</div>


<script>

/* -------------------- */
/* GLOBAL */
/* -------------------- */

let device="pc";
let ws=null;
let editing=false;
let devMode=false;
let lastContent="";

/* -------------------- */
/* DEVICE */
/* -------------------- */

function setDevice(type){

    device=type;

    document.body.classList.remove("mobile","tablet","pc");
    document.body.classList.add(type);

    document.getElementById("deviceSelect").style.display="none";

    if(type!=="pc"){
        document.getElementById("devBtn").style.display="none";
    }

    recenter();

}

/* -------------------- */
/* SIDEBAR */
/* -------------------- */

function toggleSidebar(){

    let sb=document.getElementById("sidebar");
    sb.classList.toggle("closed");

    setTimeout(recenter,300);

}

function recenter(){

    let c=document.getElementById("content");

    if(device==="pc"){
        c.classList.add("centered");
    }else{
        c.classList.remove("centered");
    }

}

/* -------------------- */
/* NAV */
/* -------------------- */

function showHome(){

    document.getElementById("homeView").style.display="block";
    document.getElementById("valuesView").style.display="none";

    document.getElementById("pageTitle").innerText="Home";

}

function showValues(){

    document.getElementById("homeView").style.display="none";
    document.getElementById("valuesView").style.display="block";

    document.getElementById("pageTitle").innerText="Values";

}

/* -------------------- */
/* DEV LOGIN */
/* -------------------- */

function devLogin(){

    let pass=prompt("Developer Password:");

    if(!pass) return;

    ws.send(JSON.stringify({
        password:pass,
        test:true
    }));

}

/* -------------------- */
/* DOC CONTROL */
/* -------------------- */

function enableEdit(){

    editing=true;
    devMode=true;

    document.getElementById("editor").style.display="block";
    document.getElementById("docBox").style.display="none";
    document.getElementById("devPanel").style.display="block";

    document.getElementById("editor").value=lastContent;

}

function saveDoc(){

    let content=document.getElementById("editor").value;

    ws.send(JSON.stringify({
        password:window.devPassword,
        content:content
    }));

    editing=false;

}

function cancelEdit(){

    editing=false;

    document.getElementById("editor").style.display="none";
    document.getElementById("docBox").style.display="block";
    document.getElementById("devPanel").style.display="none";

}

/* -------------------- */
/* WEBSOCKET */
/* -------------------- */

function connect(){

    ws=new WebSocket(
        (location.protocol==="https:"?"wss://":"ws://")
        +location.host+"/ws"
    );

    ws.onmessage=e=>{

        let data=JSON.parse(e.data);

        if(data.auth==="ok"){
            window.devPassword=data.password;
            enableEdit();
            return;
        }

        if(data.content!==undefined){

            lastContent=data.content;

            if(!editing){
                document.getElementById("docBox").innerText=data.content;
            }

        }

    };

}

connect();

/* -------------------- */
/* LOAD DOC */
/* -------------------- */

fetch("/load")
.then(r=>r.json())
.then(d=>{
    lastContent=d.content;
    document.getElementById("docBox").innerText=d.content;
});

</script>

</body>
</html>
